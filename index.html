<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./stylesheets/style.css">
    <title>Document</title>
</head>
<body>
    <h1>
        TODO LIST
    </h1>

    <p id="output"></p>

    <hr />

    <div class="div-form">
        <form action="/" onsubmit="OnClickAdd(event)">
            <h2>Add Item</h2>
            <input type="text" name="" id="txtBoxAdd" value="Type here!">
            <select name="status" id="statusOptionsAdd">
                <option value="pending">Pending</option>
                <option value="wip">WIP</option>
                <option value="done">Done</option>
            </select>
            <br />
            <br />
            <input type="submit" value="Add Item">
        </form>
    </div>

    <hr />

    <div class="div-form">
        <form action="/" onsubmit="OnClickEdit(event)">
            <h2>Edit Item Status</h2>
            <p>ID:</p>
            <input type="number" name="" id="indexBoxEdit" value="0">
            <select name="status" id="statusOptionsEdit">
                <option value="pending">Pending</option>
                <option value="wip">WIP</option>
                <option value="done">Done</option>
            </select>
            <br />
            <br />
            <input type="submit" value="Edit Item">
        </form>
    </div>

    <hr />

    <div class="div-form">
        <form action="/" onsubmit="OnClickDelete(event)">
            <h2>Delete Item</h2>
            <p>ID:</p>
            <input type="number" name="" id="indexBoxDelete" value="0">
            <br />
            <br />
            <input type="submit" value="Delete Item">
        </form>
    </div>

    <script>
        const OnClickAdd = (event) => {
            event.preventDefault();
            let textValue = document.getElementById("txtBoxAdd").value;
            let statusValue = document.getElementById("statusOptionsAdd").value;
            TodoAdd(textValue, statusValue);
        }
        const OnClickEdit = (event) => {
            event.preventDefault();
            let indexValue = document.getElementById("indexBoxEdit").value;
            let statusValue = document.getElementById("statusOptionsEdit").value;
            TodoUpdate(indexValue, statusValue);
        }
        const OnClickDelete = (event) => {
            event.preventDefault();
            let indexValue = document.getElementById("indexBoxDelete").value;
            TodoDelete(indexValue);
        }

        const todoList = []
        const TodoView = () =>
        {
            let output = '';
            if (todoList.length > 0)
            {
                output = '<b>[ID] : [Task] : [Status]</b><br />';
                let count = 0;
                todoList.forEach(e => {
                    if (status.length === 0 || e.status == status)
                    {
                        output += `${count}: ${e.task} (${GetStatusName(e.status)})<br />`;
                        count++;
                    }
                });
                output += `<br />Total <b>${todoList.length}</b> item(s).`;
            }
            document.getElementById("output").innerHTML = output;
        }
        const TodoAdd = (task, status = "pending") =>
        {
            todoList.push({
                task: task,
                status: status,
            })
            TodoView();
        }
        const TodoUpdate = (task, status) =>
        {
            todoList[task].status = status;
            TodoView();
        }
        const TodoDelete = (index) =>
        {
            const deletedItems = todoList.splice(index, 1)
            TodoView();
        }
        const GetStatusName = (value) =>
        {
            switch (value.toLowerCase()) {
                case 'pending':
                    return 'Pending';
                case 'wip':
                    return 'WIP';
                case 'done':
                    return 'Done';
                default:
                    return value;
            }
        }

        TodoView();
    </script>

    <!--External Script without variables-->
    <!-- <script src="./exercise_week2-1.js"></script> -->
    <script src="./exercise_week2-2.js"></script>
</body>
</html>